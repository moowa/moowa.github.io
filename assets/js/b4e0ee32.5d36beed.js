"use strict";(self.webpackChunkknowtes=self.webpackChunkknowtes||[]).push([[8767],{2980:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>c});const d=JSON.parse('{"id":"knowtes/powerquery","title":"Common data transformations in Power Query","description":"| | Transformation | Power Query | Pandas |","source":"@site/docs/knowtes/powerquery.md","sourceDirName":"knowtes","slug":"/knowtes/powerquery","permalink":"/docs/knowtes/powerquery","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Power Query","permalink":"/docs/tags/power-query"},{"inline":true,"label":"Data Engineering","permalink":"/docs/tags/data-engineering"},{"inline":true,"label":"data transformations","permalink":"/docs/tags/data-transformations"},{"inline":true,"label":"pandas","permalink":"/docs/tags/pandas"}],"version":"current","frontMatter":{"tags":["Power Query","Data Engineering","data transformations","pandas"],"sidebar_class_name":"hidden"},"sidebar":"tutorialSidebar","previous":{"title":"Poetry","permalink":"/docs/knowtes/poetry"},"next":{"title":"PyArrow","permalink":"/docs/knowtes/pyarrow"}}');var t=r(4848),s=r(8453);const l={tags:["Power Query","Data Engineering","data transformations","pandas"],sidebar_class_name:"hidden"},i="Common data transformations in Power Query",o={},c=[];function a(e){const n={code:"code",h1:"h1",header:"header",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"common-data-transformations-in-power-query",children:"Common data transformations in Power Query"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{children:"Transformation"}),(0,t.jsx)(n.th,{children:"Power Query"}),(0,t.jsx)(n.th,{children:"Pandas"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1"}),(0,t.jsx)(n.td,{children:"Removing Columns"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.RemoveColumns(Source, {"Column1", "Column2"})'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.drop(columns=["Column1", "Column2"])'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"2"}),(0,t.jsx)(n.td,{children:"Filtering Rows"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Table.SelectRows(Source, each [Column1] > 10)"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df[df["Column1"] > 10]'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"3"}),(0,t.jsx)(n.td,{children:"Renaming Columns"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.RenameColumns(Source, { "OldName" => "NewName" })'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.rename(columns={"OldName": "NewName"})'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"4"}),(0,t.jsx)(n.td,{children:"Adding a New Column"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.AddColumn(Source, "NewColumn", each [Column1] * 2, type number)'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df["NewColumn"] = df["Column1"] * 2'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"5"}),(0,t.jsx)(n.td,{children:"Changing Data Type"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.TransformColumnTypes(Source, { "Column1", type number })'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df["Column1"] = df["Column1"].astype(int)'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"6"}),(0,t.jsx)(n.td,{children:"Sorting Data"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.Sort(Source, {{"Column1", Order.Ascending}})'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.sort_values(by="Column1", ascending=True)'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"7"}),(0,t.jsx)(n.td,{children:"Grouping & Aggregating"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.Group(Source, {"Category"}, {{"Total", each List.Sum([Value]), type number}})'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.groupby("Category")["Value"].sum().reset_index()'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"8"}),(0,t.jsx)(n.td,{children:"Removing Duplicates"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Table.Distinct(Source)"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"df.drop_duplicates()"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"9"}),(0,t.jsx)(n.td,{children:"Merging (Joining) Tables"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.NestedJoin(Source, "ID", OtherTable, "ID", "NewTable", JoinKind.LeftOuter)'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.merge(other_df, on="ID", how="left")'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"10"}),(0,t.jsx)(n.td,{children:"Pivoting Data"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.Pivot(Source, List.Distinct(Source[Category]), "Category", "Value", List.Sum)'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.pivot_table(index="IndexColumn", columns="Category", values="Value", aggfunc="sum")'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"11"}),(0,t.jsx)(n.td,{children:"Replacing Missing/Null Values"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.ReplaceValue(Source, null, 0, Replacer.ReplaceValue, {"Column1"})'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df["Column1"] = df["Column1"].fillna(0)'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"12"}),(0,t.jsx)(n.td,{children:"Dropping Rows with Nulls"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Table.SelectRows(Source, each [Column1] <> null)"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.dropna(subset=["Column1"])'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"13"}),(0,t.jsx)(n.td,{children:"Filling Missing Values"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.FillDown(Source, {"Column1"})'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df["Column1"] = df["Column1"].ffill()'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"14"}),(0,t.jsx)(n.td,{children:"Unpivoting Data"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.UnpivotOtherColumns(Source, {"ID"}, "Attribute", "Value")'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.melt(id_vars=["ID"], var_name="Attribute", value_name="Value")'})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"15"}),(0,t.jsx)(n.td,{children:"Pivoting Data (Wide Format)"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'Table.Pivot(Source, List.Distinct(Source[Category]), "Category", "Value", List.Sum)'})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'df.pivot_table(index="ID", columns="Category", values="Value", aggfunc="sum")'})})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var d=r(6540);const t={},s=d.createContext(t);function l(e){const n=d.useContext(s);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),d.createElement(s.Provider,{value:n},e.children)}}}]);